datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// Mirrors DuckDB main_tbl
model MainTbl {
  ID               String   @id
  RowType          String?
  CounterpartyID   String?
  StartDate        DateTime?
  TerminationDate  DateTime?
  FixedRate        Float?
  NPV              Float?
  ParRate          Float?
  ParSpread        Float?
  Notional         BigInt?
  SwapType         String?
  PayFixed         Boolean?
  PricingTime      DateTime?

  @@map("main_tbl")
}

// Mirrors DuckDB risk_tbl
model RiskTbl {
  ID    String @id
  // Buckets mapped from columns that start with digits
  c_1W  Float? @map("1W")
  c_2W  Float? @map("2W")
  c_3W  Float? @map("3W")
  c_1M  Float? @map("1M")
  c_2M  Float? @map("2M")
  c_3M  Float? @map("3M")
  c_4M  Float? @map("4M")
  c_5M  Float? @map("5M")
  c_6M  Float? @map("6M")
  c_7M  Float? @map("7M")
  c_8M  Float? @map("8M")
  c_9M  Float? @map("9M")
  c_10M Float? @map("10M")
  c_11M Float? @map("11M")
  c_12M Float? @map("12M")
  c_18M Float? @map("18M")
  c_2Y  Float? @map("2Y")
  c_3Y  Float? @map("3Y")
  c_4Y  Float? @map("4Y")
  c_5Y  Float? @map("5Y")
  c_6Y  Float? @map("6Y")
  c_7Y  Float? @map("7Y")
  c_8Y  Float? @map("8Y")
  c_9Y  Float? @map("9Y")
  c_10Y Float? @map("10Y")
  c_12Y Float? @map("12Y")
  c_15Y Float? @map("15Y")
  c_20Y Float? @map("20Y")
  c_25Y Float? @map("25Y")
  c_30Y Float? @map("30Y")
  c_40Y Float? @map("40Y")

  R     Float?
  z     Float?
  RowType String?
  PricingTime      DateTime?

  @@map("risk_tbl")
}

// Mirrors DuckDB main_agg
model MainAgg {
  RowType String
  ID      String
  NPV     Float?
  Notional Decimal?
  PricingTime DateTime?

  @@id([RowType, ID])
  @@map("main_agg")
}

// Mirrors DuckDB risk_agg
model RiskAgg {
  RowType String
  ID      String

  // Buckets mapped from columns that start with digits
  c_1W  Float? @map("1W")
  c_2W  Float? @map("2W")
  c_3W  Float? @map("3W")
  c_1M  Float? @map("1M")
  c_2M  Float? @map("2M")
  c_3M  Float? @map("3M")
  c_4M  Float? @map("4M")
  c_5M  Float? @map("5M")
  c_6M  Float? @map("6M")
  c_7M  Float? @map("7M")
  c_8M  Float? @map("8M")
  c_9M  Float? @map("9M")
  c_10M Float? @map("10M")
  c_11M Float? @map("11M")
  c_12M Float? @map("12M")
  c_18M Float? @map("18M")
  c_2Y  Float? @map("2Y")
  c_3Y  Float? @map("3Y")
  c_4Y  Float? @map("4Y")
  c_5Y  Float? @map("5Y")
  c_6Y  Float? @map("6Y")
  c_7Y  Float? @map("7Y")
  c_8Y  Float? @map("8Y")
  c_9Y  Float? @map("9Y")
  c_10Y Float? @map("10Y")
  c_12Y Float? @map("12Y")
  c_15Y Float? @map("15Y")
  c_20Y Float? @map("20Y")
  c_25Y Float? @map("25Y")
  c_30Y Float? @map("30Y")
  c_40Y Float? @map("40Y")

  R     Float?
  z     Float?
  PricingTime      DateTime?

  @@id([RowType, ID])
  @@map("risk_agg")
}

// Mirrors DuckDB cashflow_tbl
model CashflowTbl {
  CounterpartyID String
  PaymentDate    DateTime
  TotalCashflow  Float?
  TotalWeight    Float?

  @@id([CounterpartyID, PaymentDate])
  @@map("cashflow_tbl")
}

// Mirrors DuckDB cashflow_risk_tbl (bucket columns mapped to c_{term})
model CashflowRiskTbl {
  CounterpartyID String
  PaymentDate    DateTime

  c_1W  Float? @map("dCF_d_1W")
  c_2W  Float? @map("dCF_d_2W")
  c_3W  Float? @map("dCF_d_3W")
  c_1M  Float? @map("dCF_d_1M")
  c_2M  Float? @map("dCF_d_2M")
  c_3M  Float? @map("dCF_d_3M")
  c_4M  Float? @map("dCF_d_4M")
  c_5M  Float? @map("dCF_d_5M")
  c_6M  Float? @map("dCF_d_6M")
  c_7M  Float? @map("dCF_d_7M")
  c_8M  Float? @map("dCF_d_8M")
  c_9M  Float? @map("dCF_d_9M")
  c_10M Float? @map("dCF_d_10M")
  c_11M Float? @map("dCF_d_11M")
  c_12M Float? @map("dCF_d_12M")
  c_18M Float? @map("dCF_d_18M")
  c_2Y  Float? @map("dCF_d_2Y")
  c_3Y  Float? @map("dCF_d_3Y")
  c_4Y  Float? @map("dCF_d_4Y")
  c_5Y  Float? @map("dCF_d_5Y")
  c_6Y  Float? @map("dCF_d_6Y")
  c_7Y  Float? @map("dCF_d_7Y")
  c_8Y  Float? @map("dCF_d_8Y")
  c_9Y  Float? @map("dCF_d_9Y")
  c_10Y Float? @map("dCF_d_10Y")
  c_12Y Float? @map("dCF_d_12Y")
  c_15Y Float? @map("dCF_d_15Y")
  c_20Y Float? @map("dCF_d_20Y")
  c_25Y Float? @map("dCF_d_25Y")
  c_30Y Float? @map("dCF_d_30Y")
  c_40Y Float? @map("dCF_d_40Y")

  @@id([CounterpartyID, PaymentDate])
  @@map("cashflow_risk_tbl")
}

// Mirrors DuckDB fixings
model Fixing {
  indexName String   @map("index")
  date      DateTime @map("date")
  value     Float?

  @@id([indexName, date])
  @@map("fixings")
}

// Mirrors DuckDB calibrations
model Calibration {
  curve_id  String
  json      String?
  timestamp DateTime

  @@id([curve_id, timestamp])
  @@map("calibrations")
}

// Mirrors DuckDB one_dimensional_market_data
model OneDimensionalMarketData {
  Term            String
  Rate            Float?
  Termination     DateTime?
  quote_type      String?
  curve_id        String
  instrument_spec String?
  quote_time      DateTime

  @@id([Term, curve_id, quote_time])
  @@map("one_dimensional_market_data")
}
